<!-- README.md -->
```
#   â–„â–„        â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„        â–„             â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„  â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„    â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„             â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ â–„         â–„ â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„ 
#  â–â–‘â–‘â–Œ      â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–Œ      â–â–‘â–Œ           â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œâ–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ  â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œ           â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œ
#  â–â–‘â–Œâ–‘â–Œ     â–â–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–â–‘â–Œâ–‘â–Œ     â–â–‘â–Œ           â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€â–â–‘â–Œ â–â–‘â–Œâ–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–Œ           â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€â–€â–€â–€â–ˆâ–‘â–ˆâ–€â–€â–€â–€â–â–‘â–Œ       â–â–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–Œ
#  â–â–‘â–Œâ–â–‘â–Œ    â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œâ–â–‘â–Œ    â–â–‘â–Œ           â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ         â–â–‘â–Œâ–â–‘â–Œ â–â–‘â–Œ         â–â–‘â–Œ       â–â–‘â–Œ           â–â–‘â–Œ         â–â–‘â–Œ              â–â–‘â–Œ    â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–Œ
#  â–â–‘â–Œ â–â–‘â–Œ   â–â–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–Œ â–â–‘â–Œ   â–â–‘â–Œâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ         â–â–‘â–Œâ–‘â–Œ  â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–Œâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„     â–â–‘â–Œ    â–â–‘â–Œ       â–â–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–Œ
#  â–â–‘â–Œ  â–â–‘â–Œ  â–â–‘â–Œâ–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œâ–â–‘â–Œ  â–â–‘â–Œ  â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ         â–â–‘â–‘â–Œ   â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œ    â–â–‘â–Œ    â–â–‘â–Œ       â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œ
#  â–â–‘â–Œ   â–â–‘â–Œ â–â–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–â–‘â–Œ   â–â–‘â–Œ â–â–‘â–Œâ–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ         â–â–‘â–Œâ–‘â–Œ  â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€â–â–‘â–ˆâ–€â–€â–€â–€â–ˆâ–‘â–ˆâ–€â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–ˆâ–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€     â–â–‘â–Œ    â–â–‘â–Œ       â–â–‘â–â–‘â–ˆâ–€â–€â–€â–€â–€â–€â–€â–€â–€ 
#  â–â–‘â–Œ    â–â–‘â–Œâ–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ    â–â–‘â–Œâ–â–‘â–Œ           â–â–‘â–Œ       â–â–‘â–â–‘â–Œ       â–â–‘â–â–‘â–Œ         â–â–‘â–Œâ–â–‘â–Œ â–â–‘â–Œ         â–â–‘â–Œ     â–â–‘â–Œ                       â–â–‘â–â–‘â–Œ              â–â–‘â–Œ    â–â–‘â–Œ       â–â–‘â–â–‘â–Œ          
#  â–â–‘â–Œ     â–â–‘â–â–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–Œ     â–â–‘â–â–‘â–Œ           â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–Œ â–â–‘â–Œâ–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„â–â–‘â–Œ      â–â–‘â–Œ             â–„â–„â–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–„â–„     â–â–‘â–Œ    â–â–‘â–ˆâ–„â–„â–„â–„â–„â–„â–„â–ˆâ–‘â–â–‘â–Œ          
#  â–â–‘â–Œ      â–â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ      â–â–‘â–‘â–Œ           â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œâ–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ  â–â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ       â–â–‘â–Œ           â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–Œ    â–â–‘â–Œ    â–â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–â–‘â–Œ          
#   â–€        â–€â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€        â–€â–€             â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€  â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€    â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€         â–€             â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€      â–€      â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€ â–€           
#                                                                                                                                                                                              
ğŸŒ€ Seamless DevOps. Powered by Swarm, Secured by Secrets.
```

<p align="center">
  <img alt="n8n" src="https://img.shields.io/badge/n8n-self--hosted-brightgreen?style=for-the-badge&logo=n8n&logoColor=white">
  <img alt="docker" src="https://img.shields.io/badge/docker-swarm-blue?style=for-the-badge&logo=docker">
  <img alt="secure" src="https://img.shields.io/badge/secrets-managed-critical?style=for-the-badge&logo=gnuprivacyguard&logoColor=white">
  <img alt="built-by" src="https://img.shields.io/badge/built%20by-pkochanowicz-F54D27?style=for-the-badge&logo=git&logoColor=white">
</p>

---

# ğŸ”§ n8n-setup-docker: Secure, Custom, Ready for Action

This repo delivers a production-friendly `n8n` stack using:

- ğŸ³ **Docker Swarm** for container orchestration  
- ğŸ” **Docker Secrets** for all sensitive env vars  
- âš™ï¸ Custom scripts to prep, deploy, and launch cleanly  
- ğŸ§  Readable, modifiable, highly hackable code  

If you want a secure, local-AND-remote deployable `n8n` instance with PostgreSQL and zero manual docker CLI pokingâ€¦  
**This is it.**

---

## ğŸ§  Project Tree

```txt
./
â”œâ”€â”€ docker-compose.yaml              # Swarm service definition
â”œâ”€â”€ Dockerfile                       # Custom n8n image with psql & logic
â”œâ”€â”€ container_run.sh                 # Entry script inside container
â”œâ”€â”€ docker_swarm_deploy.sh           # Devâ€™s best friend â€” deploys everything
â”œâ”€â”€ docker_clear_env_vars.sh         # Script to remove or unset sensitive environment variables from the shell/session.
â”œâ”€â”€ docker_destroy_container.sh      # Script to fully stop and remove Docker stack, containers, volumes, and leave Swarm.
â”œâ”€â”€ README.md                        # Project overview, usage instructions, diagrams, and badges. Your main documentation.
â”œâ”€â”€ Docker_cheatsheet.md             # Handy reference for common Docker commands tailored to your workflow.
â”œâ”€â”€ .gitignore                       # Git config file to exclude specified files/folders (like secrets, volumes, etc.) from version control.
â”œâ”€â”€ .dockerignore                    # Docker config file to exclude files/folders from being copied into Docker build context.
â”œâ”€â”€ secrets/                         # ğŸ”¥ Sensitive data here (not git-tracked!)
â”‚   â”œâ”€â”€ N8N_BASIC_AUTH_USER.txt
â”‚   â”œâ”€â”€ N8N_BASIC_AUTH_PASSWORD.txt
â”‚   â”œâ”€â”€ N8N_ENCRYPTION_KEY.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_HOST.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_PORT.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_DATABASE.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_SCHEMA.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_USER.txt
â”‚   â”œâ”€â”€ DB_POSTGRESDB_PASSWORD.txt
â”‚   â””â”€â”€ N8N_PORT.txt                  # optional
```

---

# ğŸš€ Quickstart
### 1ï¸âƒ£ Initialize Docker Swarm (if needed)

```bash
# only needed on the first run:
docker swarm init
```

---

### 2ï¸âƒ£ Add Your Secrets

Drop plain-text secret files into the ./secrets/ in the project dir. Example:

```bash

echo "admin"    > secrets/N8N_BASIC_AUTH_USER.txt
echo "hunter2"  > secrets/N8N_BASIC_AUTH_PASSWORD.txt
echo "myKeyBase" > secrets/N8N_ENCRYPTION_KEY.txt

echo "db.example.com" > secrets/DB_POSTGRESDB_HOST.txt
echo "public"         > secrets/DB_POSTGRESDB_SCHEMA.txt
echo "5432"           > secrets/DB_POSTGRESDB_PORT.txt
echo "n8n_user"       > secrets/DB_POSTGRESDB_USER.txt
echo "pa$$w0rd"       > secrets/DB_POSTGRESDB_PASSWORD.txt
echo "n8n"            > secrets/DB_POSTGRESDB_DATABASE.txt
```
And the same for your DB creds.

---

### 3ï¸âƒ£ Deploy It Like a Boss

```bash
./docker_swarm_deploy.sh
```
This will:

    ğŸ—ï¸ Build your my-n8n:latest image

    ğŸ” Create (or update) all Docker secrets

    ğŸ“¦ Deploy a Swarm stack (n8n_stack) with those secrets

    ğŸ§  Auto-detect your timezone and inject it too!

---

### 4ï¸âƒ£ Check Docker logs:

```bash
docker service logs -f n8n_stack_n8n
```
And that's it - n8n is set up and ready! In case of online deployment you'll be able to access your automations from anywhere!
(login using the values from your secret files)

---

## ğŸ” What's Actually Happening?

Your container launches via:
`container_run.sh`:

    ğŸ§ª Loads secrets from /run/secrets/â€¦

    ğŸ” Converts them into environment variables

    âœ… Tests PostgreSQL DB connection via psql

    ğŸ¬ Runs n8n ONLY if everything is healthy

ğŸ’¡ Fail fast, fail clean â€” or donâ€™t fail at all.

---

## â™»ï¸ Rotating Secrets

Secrets are immutable in Docker Swarm.
To update:

```bash
# Edit files in ./secrets/*.txt

# Then:
./docker_swarm_deploy.sh
```
This deletes+recreates them automatically.

---

### ğŸ’¾ Helpful scripts
(mostly helpful during development, not recommended for production):

#### ğŸ’¥ Getting rid of Docker Containers

Wanna burn it down?

```bash
./docker_destroy_container.sh
```
(Watch out - the script stops and removes all the Docker containers!)

---

#### ğŸ§¼ Cleaning Up env variables

In case mess in env variables is giving you a headache:

```bash
./docker_clear_env_variables.sh
```

---

#### ğŸ‘½ Need to reset n8n credentials within Docker container?

```bash
# This will list running containers, localise id or name of running container with n8n:
docker ps

# Execute n8n credentials reset command inside container:
docker exec -it <container_name_or_id> n8n user-management:reset
```

---

### ğŸ“˜ Docker Cheatsheet
ğŸ“ Check out the [Docker_cheatsheet.md](./Docker_cheatsheet.md) for more handy commands!

#### (I see you, automation fiend ğŸ˜)

---

## ğŸ’ª Powered By

| ğŸ§  Platform| ğŸŒ Link |
|------------|---------|
| ğŸ”§ **[n8n](https://n8n.io/)** â€“ powerful workflow automation | ğŸ§© [Docs](https://docs.n8n.io/) |
| ğŸ³ **[Docker](https://www.docker.com/)** â€“ containerize all the things | ğŸ“¦ [Hub](https://hub.docker.com/) |
| ğŸ˜ **[PostgreSQL](https://www.postgresql.org/)** â€“ battle-tested relational database | ğŸ“š [Docs](https://www.postgresql.org/docs/) |
| ğŸ¤– **[ChatGPT](https://chat.openai.com/)** â€“ natural language assistant magic âœ¨ | ğŸ” [OpenAI](https://openai.com/chatgpt) |

---

## ğŸš€ Free Tier PostgreSQL Hosting for n8n Self-Hosting (examples):

| ğŸ¢ Service | ğŸ’¸ Free Tier Highlights | ğŸ”— Link |
|-----------|-------------------------|---------|
| ğŸ¦„ **[Supabase](https://supabase.com/)** â€“ Open-source Firebase alternative with Postgres backend, perfect for real-time & n8n integration | ğŸ†“ 500 MB storage, 2 million requests/month, 24/7 uptime, generous free tier | ğŸ”¥ [Supabase Free](https://supabase.com/pricing) |
| â˜ï¸ **[ElephantSQL](https://www.elephantsql.com/)** â€“ Simple managed PostgreSQL hosting with free shared plans | ğŸ†“ 20 MB storage, easy to connect, ideal for dev & small projects | ğŸ˜ [ElephantSQL Plans](https://www.elephantsql.com/plans.html) |
| â˜ï¸ **[Heroku Postgres](https://www.heroku.com/postgres)** â€“ Classic cloud PaaS with free tier database | ğŸ†“ 1,000 rows, 20 connections, 10k rows/day writes, sleeps after inactivity (may impact response time) | ğŸš€ [Heroku Postgres Free](https://www.heroku.com/pricing#postgres) |
| â˜ï¸ **[Neon](https://neon.tech/)** â€“ Serverless Postgres with automatic scaling and free tier | ğŸ†“ 10 GB storage, 1 million monthly requests, modern cloud-native Postgres | âš¡ï¸ [Neon Free Tier](https://neon.tech/pricing) |
| ğŸ¦ **[Aiven](https://aiven.io/postgresql)** â€“ Fully managed PostgreSQL with free trial and credits | ğŸ 30-day free trial with $30 credit, easy migration & high availability | ğŸ‰ [Aiven Free Trial](https://aiven.io/pricing) |
| â˜ï¸ **[Citus Data on Azure](https://azure.microsoft.com/en-us/services/postgresql/)** â€“ Horizontal scale-out Postgres, free for dev/test | ğŸ†“ $200 Azure credit for 30 days + free tier options | ğŸ’ [Azure PostgreSQL](https://azure.microsoft.com/en-us/pricing/details/postgresql/) |

*State of affairs as for June 2025*

---

## â˜ï¸ Awesome Free (or Generous Trial) Shell Hosting for Remote Docker Swarm & n8n Frontend

| ğŸ¢ Service | ğŸ’¸ Free Tier / Trial Highlights | ğŸ”— Link |
|-----------|---------------------------------|---------|
| ğŸš€ **[Google Cloud Shell](https://cloud.google.com/shell)** â€“ Fully featured shell environment with 5 GB persistent storage | ğŸ†“ Always free, built-in Docker support, easy to connect via browser, perfect for lightweight dev & Docker experiments | ğŸŒ [Google Cloud Shell](https://cloud.google.com/shell) |
| ğŸ³ **[Railway](https://railway.app/)** â€“ Developer-friendly cloud with free tier for containers and shell access | ğŸ†“ $5 monthly credit (~500 hours), easy deployment, Docker support, persistent volumes | ğŸ‰ [Railway Free Tier](https://railway.app/pricing) |
| â˜ï¸ **[Fly.io](https://fly.io/)** â€“ Global app hosting with Docker container support, 3 shared CPUs | ğŸ†“ 3 shared CPUs, 256 MB RAM, 3 GB persistent volume, free 1600 CPU hours/month | âœˆï¸ [Fly.io Free Tier](https://fly.io/docs/about/pricing/) |
| ğŸ§ **[Oracle Cloud Free Tier](https://www.oracle.com/cloud/free/)** â€“  Always free compute instances with shell access | ğŸ†“ 2 AMD VMs with 1/8 OCPU each, 1 GB RAM, Docker installable, 100 GB block storage | ğŸ˜ [Oracle Cloud Free Tier](https://www.oracle.com/cloud/free/) |
| ğŸ¦„ **[AWS Free Tier (EC2)](https://aws.amazon.com/free/)** â€“ Free micro instance for 12 months with full shell access | ğŸ†“ 750 hrs/month t2.micro/t3.micro, Docker installable, perfect for small dev projects | â˜ï¸ [AWS Free Tier](https://aws.amazon.com/free/) |
| ğŸ³ **[DigitalOcean App Platform](https://www.digitalocean.com/products/app-platform/)** â€“ Easy Docker container deploy with free starter plan | ğŸ†“ Starter tier with 3 static sites, 1 container, 100 GB bandwidth | ğŸš€ [DigitalOcean App Platform](https://www.digitalocean.com/pricing/) |

*State of affairs as for June 2025*

---

## ğŸµ Development plans:

- Kubernetes orchestration of containers with various customizable settings.
- Increase of installation options of popular services n8n connects to on setup.
- A script to dump workflows and creds from n8n regularly (via API or CLI). Re-import them with new keys and never lose your data.
- Much more to come...

---

Â© 2025 PaweÅ‚ Kochanowicz Â· [GitHub](https://github.com/pkochanowicz)

This project is licensed under the [MIT License](LICENSE).